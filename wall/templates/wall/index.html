<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Стенгазета проектов</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'wall/main.css' %}?v=4">
</head>
<body>
    <div id="wall-root">
        <div id="wall-container">
            {% for project in projects %}
            <div class="tile" 
                 data-project-id="{{ project.id }}"
                 data-slug="{{ project.slug }}"
                 data-accent-color="{{ project.accent_color }}"
                 data-priority="{{ project.priority }}"
                 data-title="{{ project.title }}"
                 data-excerpt="{{ project.get_excerpt }}"
                 data-cover-url="{% if project.cover %}{{ project.cover.url }}{% endif %}">
                
                {% if project.cover %}
                <div class="tile-cover" style="background-image: url('{{ project.cover.url }}');"></div>
                {% endif %}
                
                <div class="tile-content">
                    <h2 class="tile-title">{{ project.title }}</h2>
                    <p class="tile-excerpt">{{ project.get_excerpt }}</p>
                </div>
                
                <div class="tile-border"></div>
            </div>
            {% endfor %}
        </div>
        
        <!-- Кнопка перемешивания -->
        <button id="shuffle-btn" title="Перемешать раскладку">🎲</button>
    </div>
    
    <!-- Модалка проекта -->
    <div id="project-modal" class="modal">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <button class="modal-close">&times;</button>
            <div class="modal-body">
                <!-- Контент загружается динамически -->
            </div>
        </div>
    </div>
    
    <script src="{% static 'wall/layout.js' %}?v=4"></script>
    <script>
        // Передаем данные в JS
        window.wallData = {
            projects: [
                {% for project in projects %}
                {
                    id: {{ project.id }},
                    title: "{{ project.title|escapejs }}",
                    slug: "{{ project.slug }}",
                    excerpt: "{{ project.get_excerpt|escapejs }}",
                    accent_color: "{{ project.accent_color }}",
                    priority: {{ project.priority }},
                    cover_url: "{% if project.cover %}{{ project.cover.url }}{% endif %}"
                }{% if not forloop.last %},{% endif %}
                {% endfor %}
            ],
            seed: "{{ seed }}"
        };
    </script>
</body>
</html>
